### Demo Project: Create Helm Chart for Microservices

---

![Alt text](img/architecture-diagram.png)
### Technologies Used:
Kubernetes, Helm

### Project Objectives:
- Create 1 shared Helm Chart for all microservices, to reuse common Deployment and Service configurations for the services.
---
### Create Helm Chart
config.yaml: https://github.com/KajalLad1206/k8s-microservices-demo/blob/main/k8s-microservice-yaml/config.yaml

1. two main ways to create helm charts
    - one helm chart for each microservice
        - when configurations are very different
    - one shared helm chart for all microservices
    - can use a combination of both of the above options
        - shared chart for similar applications
        - separate charts for completely different apps
2. for this demo, we will create a shared chart
    - `helm create <chart-name>`
        - creates a directory
            - Chart.yaml
            - values.yaml (will have the actual values for the template files)
            - charts folder (holds chart dependencies)
            - templates folder (where the actual K8s YAML files (template files) are created)
            - .helmignore (designate files to not include in the helm chart)
3. setup template files
    - remove or comment content of autogenerated files from the templates folder, except deployment.yaml and service.yaml
    - delete contents of deployment.yaml, service.yaml, and values.yaml
4. create template files
    - "Values" Object
        - a built-in object
        - empty by default
        - values are passed into the template from 3 sources
            - values.yaml file in the chart
            - user-supplied file passed with -f flag
            - parameter passed with --set flag
    - service.yaml: https://github.com/KajalLad1206/k8s-microservices-demo/blob/main/microservices-with-helmchart/charts/microservice/templates/service.yaml
    - deployment.yaml: https://github.com/KajalLad1206/k8s-microservices-demo/blob/main/microservices-with-helmchart/charts/microservice/templates/deployment.yaml
    - values.yaml (setting default values): https://github.com/KajalLad1206/k8s-microservices-demo/blob/main/microservices-with-helmchart/charts/microservice/values.yaml
5. create specific values template file for each service
    - `helm template -f <template-file-name> <chart-name>`
        - render chart templates locally and display the output (used to validate template values are being used)
    - `helm lint`
        - checks chart for possible issues
            - ERROR = issues that will cause the chart to fail installation
            - WARNING = issues that break with convention or recommendations
    - email-service-values.yaml: https://github.com/KajalLad1206/k8s-microservices-demo/blob/main/microservices-with-helmchart/values/email-service-values.yaml
        - deploy the email service
        - `helm install -f email-service-values.yaml emailservice microservice`
    - values folder with all of the yaml files for each service: https://github.com/KajalLad1206/k8s-microservices-demo/tree/main/microservices-with-helmchart/values
6. create a chart for redis
    - service.yaml: https://github.com/KajalLad1206/k8s-microservices-demo/blob/main/microservices-with-helmchart/charts/redis/templates/service.yaml
    - deployment.yaml: https://github.com/KajalLad1206/k8s-microservices-demo/blob/main/microservices-with-helmchart/charts/redis/templates/deployment.yaml
    - values.yaml: https://github.com/KajalLad1206/k8s-microservices-demo/blob/main/microservices-with-helmchart/charts/redis/values.yaml
    - redis-values.yaml: https://github.com/KajalLad1206/k8s-microservices-demo/blob/main/microservices-with-helmchart/values/redis-values.yaml
7. check generated manifest
    - `helm install --dry-run -f <service-values-yaml> <release-name> <chart-name>` command
        - check generated manifest without installing the chart
        - --dry-run sends files to K8s cluster, while template only validates it locally
---